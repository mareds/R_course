<!DOCTYPE html>
<html>
<head>
  <title>Data Analysis with R</title>
  <meta charset="utf-8">
  <meta name="description" content="Data Analysis with R">
  <meta name="author" content="Saskia A. Otto">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <!-- the following meta tag added by me (SAO) -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/phone.css"
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/sao_theme.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->  <link rel=stylesheet href="libraries/widgets/quiz/css/demo.css"></link>
<link rel=stylesheet href="libraries/widgets/bootstrap/css/bootstrap.css"></link>
<link rel=stylesheet href="libraries/widgets/interactive/css/aceeditor.css"></link>
<link rel=stylesheet href="./assets/css/box_styles.css"></link>
<link rel=stylesheet href="./assets/css/ribbons.css"></link>
<link rel=stylesheet href="./assets/css/style.css"></link>


  <!-- Grab CDN jQuery, fall back to local if offline -->
  <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery.js"><\/script>')</script>
  <script data-main="libraries/frameworks/io2012/js/slides"
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>

  

</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">

    <!-- LOGO SLIDE -->
      <slide class="nobackground">
    <article class="flexbox vcenter">
      <span>
        <img width='500px' src="assets/img/BigLogo_MDS.png">
      </span>
    </article>
  </slide>
    <slide class="title-slide segue nobackground">
  <!-- <aside class="gdbar">
    <img src="assets/img/uham_logo.png">
  </aside>-->
  <div style="position: absolute; left: 50px; top: 50px; z-index:100">
      <img src = "assets/img/uham_logo.png" height="67" width="200">
  </div>
  <hgroup class="auto-fadein">
    <h1>Data Analysis with R</h1>
    <h2>14 - Model building and selection</h2>
    <p>Saskia A. Otto<br/>Postdoctoral Researcher</p>
  </hgroup>
  <article></article>
</slide>


    <!-- SLIDES -->
    <slide class="segue" style="background:#1874CD;">
  <hgroup>
    <h1>Model building</h1>
  </hgroup>
  <article>
    <p><img src="img/Data_science_1c.png" style="height:150px;border:0;position: absolute; left: 900px; top: 50px" </img></p>

  </article>
</slide>
<slide class="" id="slide-2" style="background:;">
  <hgroup>
    <h2>Model building in 6 steps</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="img/Model_building_6steps.png" style="width:600px;border:0;position: absolute; left: 250px; top: 125px" </img></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-3" style="background:;">
  <article data-timings="">
    <p><img src="img/Model_building_6steps_1.png" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" width="850px" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-4" style="background:;">
  <article data-timings="">
    <p><img src="img/Model_building_6steps_2.png" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" width="850px" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-5" style="background:;">
  <article data-timings="">
    <p><img src="img/Model_building_6steps_3.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" width="850px" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-6" style="background:;">
  <article data-timings="">
    <p><img src="img/Model_building_6steps_4.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" width="850px" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-7" style="background:;">
  <article data-timings="">
    <p><img src="img/Model_building_6steps_5.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" width="850px" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-8" style="background:;">
  <article data-timings="">
    <p><img src="img/Model_building_6steps_6.png" title="plot of chunk unnamed-chunk-6" alt="plot of chunk unnamed-chunk-6" width="850px" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-9" style="background:;">
  <article data-timings="">
    <p><img src="img/Model_building_6steps_7.png" title="plot of chunk unnamed-chunk-7" alt="plot of chunk unnamed-chunk-7" width="850px" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-10" style="background:;">
  <article data-timings="">
    <p><img src="img/Model_building_6steps_7.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="850px" style="display: block; margin: auto;" /></p>

<div class="alert alert-orange" style="position: absolute; left: 25px; top: 10px">
  <small>NOTE: You can do step 1-6 also with different model families, compare them and select the one that fits best.</small>
</div>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#6495ED;">
  <hgroup>
    <h1>1. Defining the model family</h1>
  </hgroup>
  <article>
    <p><img src="img/Model_building_6steps_1b.png" style="height:250px;border:0;position: absolute; left: 750px; top: 50px" </img> </p>

  </article>
</slide>
<slide class="" id="slide-12" style="background:;">
  <hgroup>
    <h2>Aim</h2>
  </hgroup>
  <article data-timings="">
    <h3>You want to find the function that best explains Y</h3>

<p>\[Y_{i} =  f(\mathbf{X_{i}}) + \epsilon_{i}\]</p>

<div class="alert alert-green" style="position: absolute; left: 330px; top: 250x">
  <h4>Note:</h4> <small style="font-size:20px;">X can be also a vector of several explanatory variables.</small>
</div>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-13" style="background:;">
  <hgroup>
    <h2>The function for a straight line is \(Y = a + bX\)</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="lecture14_plotting_files/unnamed-chunk-9-1.png" title="plot of chunk unnamed-chunk-9" alt="plot of chunk unnamed-chunk-9" width="936" style="display: block; margin: auto;" /></p>

<p>Where <em>y</em> is the dependent variable, <em>a</em> is the intercept, which is the value at which the line crosses the y-axis (when x is zero), <em>b</em> is the coefficent for the slope, and <em>x</em> is the independent variable.</p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-14" style="background:;">
  <hgroup>
    <h2>Quadratic relationships \(Y=a+bX+cX^{2}\)</h2>
  </hgroup>
  <article data-timings="">
    <p>When the effect of an explanatory variable X changes with increasing or decreasing values of X a model with polynomial terms might be a better option.</p>

<p>The quadratic dependence has three parameters and so can produce a variety of parabolas.</p>

<p><img src="lecture14_plotting_files/unnamed-chunk-10-1.png" title="plot of chunk unnamed-chunk-10" alt="plot of chunk unnamed-chunk-10" width="936" style="display: block; margin: auto;" /></p>

<p><small> <strong>a</strong> controls how quickly the parabola increases with X. If it is positive the parabola goes up and is trough-shaped, a negative value of a inverts the parabola. The parameter <strong>c</strong> controls the height of the parabola and the value of <strong>b</strong> controls the sideways displacement of the parabola. </small></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-15">
  <hgroup>
    <h2>Taylor’s theorem</h2>
  </hgroup>
  <article class = 'flexbox vcenter'>
    <div class="img-with-text" style="position: absolute; left: 950px; top: 25px; z-index:100">
    <img src="img/wikipedia_b_taylor.jpg" alt="B Taylor" width=75px height=100px>
 <p><span class="source-img" style = "float:right">
    <a href='https://en.wikipedia.org/wiki/Brook_Taylor' title=''>Brook Taylor</a></span></p>
</div>

<ul>
<li><p><a href="https://en.wikipedia.org/wiki/Taylor%27s_theorem">Taylor’s theorem</a> says that you can approximate any smooth function with an infinite sum of polynomials. </p></li>
<li><p>You can use a polynomial function to get arbitrarily close to a smooth function by fitting an equation like \(Y = a + bX + cX^{2} + dX^{3} +eX^{4}\)</p></li>
<li><p>R provides helper functions that produce orthogonal (i.e. uncorrelated) polynomials</p>

<ul>
<li><code>poly(X, degree = 4)</code> → problem: outside the data range of the data predictions shoot off to +/- Inf</li>
<li>alternative: use the natural spline with <code>splines::ns(X, df = 4)</code></li>
</ul></li>
</ul>

<p><span class="source-img" style="position: absolute; left: 700px; top: 650px">source image:
    <a href='https://en.wikipedia.org/wiki/Brook_Taylor#/media/File:BTaylor.jpg' title=''>Wikipedia</a> (under CCO licence)</span></p>  

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-16" style="background:;">
  <hgroup>
    <h2>Exponential growth or decay</h2>
  </hgroup>
  <article data-timings="">
    <p>Curves following exponential growth or decay occur in many areas of biology. A general exponential growth is represented by \(Y =a * e^{bX}\), a decay by \(Y = a * e^{-bX}\).</p>

<p><img src="lecture14_plotting_files/unnamed-chunk-11-1.png" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" width="936" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-17" style="background:;">
  <hgroup>
    <h2>Exponential growth or decay</h2>
  </hgroup>
  <article data-timings="">
    <p>Curves following exponential growth or decay occur in many areas of biology. A general exponential growth is represented by \(Y =a * e^{bX}\), a decay by \(Y = a * e^{-bX}\).</p>

<p><img src="lecture14_plotting_files/unnamed-chunk-12-1.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" width="936" style="display: block; margin: auto;" /></p>

<div class="alert alert-green" style="position: absolute; left: 25; top: 585px">
  <small style="font-size:10px">Since the natural log is the inverse function of an exponential function, ln(exp(x)) = x, an exponential curve can be changed into a linear relationship by taking the natural log of both sides of the equation.</small>
</div>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-18" style="background:;">
  <hgroup>
    <h2>Linearizating relationships through transformations</h2>
  </hgroup>
  <article data-timings="">
    <div class="img-with-text" style="position: absolute; left: 100px; top: 120px; z-index:100">
    <img src="img/Zuur_transformations.png" alt="" width=800px height=400px />
 <p><span class="source-img" style = "float:right">
    source: <a href='http://highstat.com/index.php/analysing-ecological-data' title=''>Zuur et al., 2007 (Chapter 4)</a></span></p>
</div>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-19" style="background:;">
  <hgroup>
    <h2>Example: Weight ~ Length relationship</h2>
  </hgroup>
  <article data-timings="">
    <p>A typical example for a linear relationship, which cannot be described by linear graph, is in marine biology the weight-length relationships. For most species, it will follow a 2 parameter power function: \(W = aL^{b}\)</p>

<div style='float:left;width:48%;'>
  <p><small>Lengths and weights for Chinook Salmon from three locations in Argentina (data is provided in the <a href="https://cran.r-project.org/web/packages/FSA/index.html">FSA</a> package).</small></p>

</div>
<div style='float:right;width:48%;'>
  <p><img src="lecture14_plotting_files/unnamed-chunk-13-1.png" title="plot of chunk unnamed-chunk-13" alt="plot of chunk unnamed-chunk-13" width="432" style="display: block; margin: auto;" /></p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-20" style="background:;">
  <hgroup>
    <h3>Applying the bulging rule</h3>
  </hgroup>
  <article data-timings="">
    <p><img src="lecture14_plotting_files/unnamed-chunk-14-1.png" title="plot of chunk unnamed-chunk-14" alt="plot of chunk unnamed-chunk-14" width="720" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-21" style="background:;">
  <hgroup>
    <h2>General rule for common transformations</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><strong>Square root</strong> transformation: <code>sqrt()</code>

<ul>
<li>Count data.</li>
<li>Variance is about equal to the mean.</li>
</ul></li>
<li><strong>Log</strong> transformation: <code>log()</code>

<ul>
<li>Variances are not similar or larger than the mean.</li>
<li>If the variables contains zeros add a constant (should be a proportionally small value) to each of the observations: <code>log(X+1)</code> or <code>log1p()</code></li>
<li>to back calculate: <code>exp(X_log)</code> or <code>expm1(X_log)</code> if 1 was added</li>
</ul></li>
<li><strong>Arcsine</strong> transformation: <code>asin()</code>

<ul>
<li>Percentages and proportions</li>
</ul></li>
</ul>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#6495ED;">
  <hgroup>
    <h1>2. Generate a fitted model</h1>
  </hgroup>
  <article>
    <p><img src="img/Model_building_6steps_2b.png" style="height:250px;border:0;position: absolute; left: 750px; top: 50px" </img> </p>

  </article>
</slide>
<slide class="" id="slide-23" style="background:;">
  <hgroup>
    <h2>Once you defined the model family</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>you can estimate the coefficients (in an iterative process) yourself</li>
<li>or you select the appropriate R function and the coefficents are automatically estimated.</li>
<li>The choice of function depends on the model family but also the <strong>data type</strong> and <strong>distribution of Y</strong>:</li>
</ul>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-24" style="background:;">
  <hgroup>
    <h2>An overview of common linear models</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="img/Common_models_overview.png" title="plot of chunk unnamed-chunk-15" alt="plot of chunk unnamed-chunk-15" width="1000px" /></p>

<!-- |Data Type Y | Data Type X | Distribution Y | R Function | Statistical Model -->

<!-- |:----------:|:-----------:|:--------------:|:----------:|:---------------:| -->

<!-- | continuous | continuous | Gaussian | `lm()` | normal linear regression | -->

<!-- | continuous | categorical | Gaussian | `aov()` or `lm()` | Analysis of Variance (ANOVA)| -->

<!-- | continuous | both | Gaussian | `lm()` | Analysis of Covariance (ANCOVA) | -->

<!-- | count | both | Poisson, negative bionomial | `glm()` | log-linear models (Poisson / NB regression) | -->

<!-- | proportion | both | binomial | `glm()` | binomial logistic regression | -->

<!-- | binary | both | Bernoulli | `glm()` | logistic regression | -->

<!-- | categorical (> 2 classes) | both | multinomial | `glm()` | multinomial logistic regression (seldom)| -->

<!-- | categorical (> 2 classes) | both | Gaussian | `MASS::lda()` | linear discriminant analysis| -->

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-25" style="background:;">
  <hgroup>
    <h2>Defining the model family in the R formula</h2>
  </hgroup>
  <article data-timings="">
    <h3>Focus on simple normal linear regression models</h3>

<ol>
<li>Straight line: <code>lm(formula = Y ~ X, data)</code></li>
<li>Relationship with polynomials: 

<ul>
<li>Quadratic: <code>lm(Y ~ poly(X,2), data)</code> or <code>~ splines::ns(X, 2)</code> </li>
<li>Cubic: <code>lm(Y ~ poly(X,3), data)</code> or <code>~ splines::ns(X, 3)</code> </li>
</ul></li>
<li>Linearize the relationship:

<ul>
<li><code>lm(formula = log(Y) ~ X, data)</code></li>
<li><code>lm(formula = Y ~ log(X), data)</code></li>
<li><code>lm(formula = log(Y) ~ log(X), data)</code></li>
</ul></li>
</ol>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-26" style="background:;">
  <hgroup>
    <h2>Formulas</h2>
  </hgroup>
  <article data-timings="">
    <p>You can see how R defines the model by using <code>model_matrix()</code> from the <em>modelr</em> package</p>

<pre><code class="r">df &lt;- data.frame(y = c(10,20, 30), x1 = c(5,10,15))
model_matrix(df, y ~ x1)
</code></pre>

<pre><code class="no-highlight">## # A tibble: 3 x 2
##   `(Intercept)`    x1
##           &lt;dbl&gt; &lt;dbl&gt;
## 1             1     5
## 2             1    10
## 3             1    15
</code></pre>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-27" style="background:;">
  <hgroup>
    <h2>Formulas (cont)</h2>
  </hgroup>
  <article data-timings="">
    <p>Now with polynomials</p>

<pre><code class="r">model_matrix(df, y ~ poly(x1, 2))
</code></pre>

<pre><code class="no-highlight">## # A tibble: 3 x 3
##   `(Intercept)` `poly(x1, 2)1` `poly(x1, 2)2`
##           &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
## 1             1      -7.07e- 1          0.408
## 2             1      -9.42e-17         -0.816
## 3             1       7.07e- 1          0.408
</code></pre>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-28" style="background:;">
  <hgroup>
    <h2>Categorical X variables</h2>
  </hgroup>
  <article data-timings="">
    <p>If <em>X</em> is categorical it doesn&#39;t make much sense to model \(Y = a + bX\) as \(X\) cannot be multiplied with \(b\). But R has a workaround:</p>

<ul>
<li>categorical predictors are <strong>converted into multiple continuous predictors</strong></li>
<li>these are so-called <strong>dummy variables</strong></li>
<li>each dummy variable is coded as <strong>0 (FALSE)</strong> or <strong>1 (TRUE)</strong></li>
<li>the no. of dummy variables = no. of groups <strong>minus 1</strong></li>
<li>all linear models fit categorical predictors using dummy variables</li>
</ul>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-29" style="background:;">
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p>The data</p>

<pre><code class="r">df
</code></pre>

<pre><code class="no-highlight">##       y length
## 1   5.3      S
## 2   7.4      S
## 3  11.3      L
## 4  17.9      M
## 5   3.9      L
## 6  17.6      M
## 7  18.4      L
## 8  12.8      L
## 9  12.1      M
## 10  1.1      L
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <p>The dummy variables</p>

<pre><code class="r">model_matrix(df, y ~ length)
</code></pre>

<pre><code class="no-highlight">## # A tibble: 10 x 3
##    `(Intercept)` lengthM lengthS
##            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1             1       0       1
##  2             1       0       1
##  3             1       0       0
##  4             1       1       0
##  5             1       0       0
##  6             1       1       0
##  7             1       0       0
##  8             1       0       0
##  9             1       1       0
## 10             1       0       0
</code></pre>

<p><span style="font-size:25px; font-weight:bold; color:#ff0039">Where did the length class <strong>L</strong> go? </span> </p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-30" style="background:;">
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p>The data</p>

<pre><code class="r">df
</code></pre>

<pre><code class="no-highlight">##       y length
## 1   5.3      S
## 2   7.4      S
## 3  11.3      L
## 4  17.9      M
## 5   3.9      L
## 6  17.6      M
## 7  18.4      L
## 8  12.8      L
## 9  12.1      M
## 10  1.1      L
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <p>The dummy variables</p>

<pre><code class="r">model_matrix(df, y ~ length)
</code></pre>

<pre><code class="no-highlight">## # A tibble: 10 x 3
##    `(Intercept)` lengthM lengthS
##            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1             1       0       1
##  2             1       0       1
##  3             1       0       0
##  4             1       1       0
##  5             1       0       0
##  6             1       1       0
##  7             1       0       0
##  8             1       0       0
##  9             1       1       0
## 10             1       0       0
</code></pre>

<p><span style="font-size:25px; font-weight:bold; color:#ff0039"><strong>L</strong> is represented by the <strong>intercept</strong> ! </span> </p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-31" style="background:;">
  <hgroup>
    <h2>Overview of model formulae in R</h2>
  </hgroup>
  <article data-timings="">
    <div class="img-with-text" style="position: absolute; left: 200px; top: 100px; z-index:100">
    <img src="img/Model_formulae_Crawley2007.png" alt="Formulae in R" width=700px height=600px />
 <p><span class="source-img" style = "float:right">source: 
    <a href='http://onlinelibrary.wiley.com/book/10.1002/9780470515075' title=''>Crawley (2007)</a></span></p>
</div>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#6495ED;">
  <hgroup>
    <h1>3. Partition your model</h1>
  </hgroup>
  <article>
    <p><img src="img/Model_building_6steps_3b.png" style="height:250px;border:0;position: absolute; left: 750px; top: 50px" </img> </p>

  </article>
</slide>
<slide class="" id="slide-33" style="background:;">
  <hgroup>
    <h3>Partition your model into predicted values and residuals</h3>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p>Predicted values: Check <strong>modelfit</strong>
<img src="lecture14_plotting_files/unnamed-chunk-24-1.png" title="plot of chunk unnamed-chunk-24" alt="plot of chunk unnamed-chunk-24" width="432" /></p>

</div>
<div style='float:right;width:48%;'>
  <p>Residuals: Check <strong>assumptions</strong>
<img src="lecture14_plotting_files/unnamed-chunk-25-1.png" title="plot of chunk unnamed-chunk-25" alt="plot of chunk unnamed-chunk-25" width="432" /></p>

<p><img src="lecture14_plotting_files/unnamed-chunk-26-1.png" title="plot of chunk unnamed-chunk-26" alt="plot of chunk unnamed-chunk-26" width="432" /></p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#6495ED;">
  <hgroup>
    <h1>4. Model the remaining noise</h1>
  </hgroup>
  <article>
    <p><img src="img/Model_building_6steps_4b.png" style="height:250px;border:0;position: absolute; left: 750px; top: 50px" </img> </p>

  </article>
</slide>
<slide class="" id="slide-35" style="background:;">
  <hgroup>
    <h2>2 different ways to understand what the model captures</h2>
  </hgroup>
  <article data-timings="">
    <ol>
<li>Study the model family and fitted coefficients (common in statistical modelling courses).</li>
<li>Understanding a model by looking at its predictions and what it does not capture (the pattern in the residuals, i.e. the deviation of each observation from its predicted value) (getting more popular these days).

<ul>
<li>Particularly studying the residuals helps to identify less pronounced patterns in the data.</li>
</ul></li>
</ol>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-36" style="background:;">
  <hgroup>
    <h2>Residual patterns</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p>A typical example where residuals are modelled is in fishery ecology when studying recruitment success:</p>

<div class="img-with-text" style="position: absolute; left: 600px; top: 50px; z-index:100">
    <img src="img/Recr_residuals.png" alt="RecRes" width =375 />
 <p><span class="source-img" style = "float:right">
    <a href='https://www.researchgate.net/publication/288667847_STATISTICAL_INFERENCES_REGARDING_THE_HIGH_AND_LOW_RECRUITMENT_SCENARIOS_BASED_ON_THE_OUTPUT_FROM_THE_2012_AND_2014_STOCK_ASSESSMENTS_FOR_WESTERN_ATLANTIC_BLUEFIN_TUNA_A_PRELIMINARY_ANALYSIS_USING_THE_' title=''>Bluefin Species Group, 2015, Collect. Vol. Sci. Pap. ICCAT, 71(4): 1863-1869</a></span></p>
</div>

</div>
<div style='float:right;width:48%;'>
  
</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-37" style="background:;">
  <hgroup>
    <h2>Best practice:</h2>
  </hgroup>
  <article data-timings="">
    <h3>Model the residual ~ every X variable not included in the model</h3>

<p><img src="lecture14_plotting_files/unnamed-chunk-27-1.png" title="plot of chunk unnamed-chunk-27" alt="plot of chunk unnamed-chunk-27" width="576" style="display: block; margin: auto;" /></p>

<p>Residuals show a distinct pattern: The model seems to underestimate the weight in Argentina and overestimate  in Puyehue.</p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#6495ED;">
  <hgroup>
    <h1>5. Extend your fitted model with more X</h1>
  </hgroup>
  <article>
    <p><img src="img/Model_building_6steps_5b.png" style="height:250px;border:0;position: absolute; left: 750px; top: 50px" </img> </p>

  </article>
</slide>
<slide class="" id="slide-39" style="background:;">
  <hgroup>
    <h3>Chinook Salmon example: add <code>loc</code> as X variable to the model</h3>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">mod2 &lt;- lm(formula = w_log ~ tl_log + loc, data = ChinookArg)
# alternatively
mod2 &lt;- update(mod, .~. + loc)
</code></pre>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-40" style="background:;">
  <article data-timings="">
    <p>Check modelfit and diagnostics again</p>

<div style='float:left;width:48%;'>
  <p><img src="lecture14_plotting_files/unnamed-chunk-29-1.png" title="plot of chunk unnamed-chunk-29" alt="plot of chunk unnamed-chunk-29" width="432" /></p>

</div>
<div style='float:right;width:48%;'>
  <p><img src="lecture14_plotting_files/unnamed-chunk-30-1.png" title="plot of chunk unnamed-chunk-30" alt="plot of chunk unnamed-chunk-30" width="432" /></p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-41" style="background:;">
  <article data-timings="">
    <pre><code class="r">summary(mod2)
</code></pre>

<pre><code class="no-highlight">## 
## Call:
## lm(formula = w_log ~ tl_log + loc, data = ChinookArg)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.60633 -0.19351 -0.00076  0.14352  1.61286 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -8.12169    0.56827 -14.292  &lt; 2e-16 ***
## tl_log       2.30492    0.12563  18.347  &lt; 2e-16 ***
## locPetrohue -0.22813    0.08013  -2.847  0.00528 ** 
## locPuyehue  -0.45699    0.09231  -4.951 2.74e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3186 on 108 degrees of freedom
## Multiple R-squared:  0.8962, Adjusted R-squared:  0.8934 
## F-statistic:   311 on 3 and 108 DF,  p-value: &lt; 2.2e-16
</code></pre>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#6495ED;">
  <hgroup>
    <h1>6. Test for interactions</h1>
  </hgroup>
  <article>
    <p><img src="img/Model_building_6steps_6b.png" style="height:250px;border:0;position: absolute; left: 750px; top: 50px" </img> </p>

  </article>
</slide>
<slide class="" id="slide-43" style="background:;">
  <hgroup>
    <h3>Chinook Salmon example: include <code>tl_log:loc</code> interaction</h3>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">mod3 &lt;- lm(formula = w_log ~ tl_log * loc, data = ChinookArg)
# alternatively
mod3 &lt;- update(mod2, .~. + tl_log:loc)
</code></pre>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-44" style="background:;">
  <article data-timings="">
    <p>Check modelfit and diagnostics again</p>

<div style='float:left;width:48%;'>
  <p><img src="lecture14_plotting_files/unnamed-chunk-33-1.png" title="plot of chunk unnamed-chunk-33" alt="plot of chunk unnamed-chunk-33" width="432" /></p>

</div>
<div style='float:right;width:48%;'>
  <p><img src="lecture14_plotting_files/unnamed-chunk-34-1.png" title="plot of chunk unnamed-chunk-34" alt="plot of chunk unnamed-chunk-34" width="432" /></p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-45" style="background:;">
  <article data-timings="">
    <pre><code class="r">summary(mod3)
</code></pre>

<pre><code class="no-highlight">## 
## Call:
## lm(formula = w_log ~ tl_log + loc + tl_log:loc, data = ChinookArg)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.58273 -0.18471 -0.00186  0.13088  1.63620 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         -6.6750     1.5904  -4.197 5.64e-05 ***
## tl_log               1.9836     0.3530   5.619 1.56e-07 ***
## locPetrohue         -2.3957     3.1494  -0.761    0.449    
## locPuyehue          -2.0696     1.6868  -1.227    0.223    
## tl_log:locPetrohue   0.4795     0.6928   0.692    0.490    
## tl_log:locPuyehue    0.3624     0.3793   0.955    0.342    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3201 on 106 degrees of freedom
## Multiple R-squared:  0.8972, Adjusted R-squared:  0.8924 
## F-statistic:   185 on 5 and 106 DF,  p-value: &lt; 2.2e-16
</code></pre>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#1874CD;">
  <hgroup>
    <h1>Interpreting models with categorical X variables</h1>
  </hgroup>
  <article>
    <p><img src="img/Data_science_1c.png" style="height:150px;border:0;position: absolute; left: 900px; top: 50px" </img> </p>

  </article>
</slide>
<slide class="" id="slide-47" style="background:;">
  <hgroup>
    <h2>Recall: Categorical X variables</h2>
  </hgroup>
  <article data-timings="">
    <p>If <em>X</em> is categorical it doesn&#39;t make much sense to model \(Y ~ a + bX\) as \(X\) cannot be multiplied with \(b\). But R has a workaround:</p>

<ul>
<li>categorical predictors are <strong>converted into multiple continuous predictors</strong></li>
<li>these are so-called <strong>dummy variables</strong></li>
<li>each dummy variable is coded as <strong>0 (FALSE)</strong> or <strong>1 (TRUE)</strong></li>
<li>the no. of dummy variables = no. of groups <strong>minus 1</strong></li>
<li>all linear models fit categorical predictors using dummy variables</li>
</ul>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-48" style="background:;">
  <hgroup>
    <h2>Only categorical X</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p>Differences of Chinook Salmon weight between three locations in Argentina</p>

<pre><code class="r">chin_mod &lt;- lm(w_log ~ loc, ChinookArg)
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <p><img src="lecture14_plotting_files/unnamed-chunk-37-1.png" title="plot of chunk unnamed-chunk-37" alt="plot of chunk unnamed-chunk-37" width="504" style="display: block; margin: auto;" /></p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#EEC900;">
  <hgroup>
    <h1>Your turn...</h1>
  </hgroup>
  <article>
    
  </article>
</slide>
<slide class="" id="slide-50">
<hgroup>
  <h1>How would you interpret these coefficients?</h1>
</hgroup>
<article data-timings="">
  <div style="background-color:#F5F5F5; text-align:left; vertical-align: middle; padding:20px 47px;">
    <pre><code class="r">chin_mod &lt;- lm(w_log ~ loc, ChinookArg)
coef(chin_mod)
</code></pre>

<pre><code class="no-highlight">## (Intercept) locPetrohue  locPuyehue 
##  2.25605528 -0.09844412 -1.52993775
</code></pre>

<p>What is the regression equation for each location?</p>

  </div>
  <footer>
    <div style="position: absolute; left: 60px; top: 645px; z-index:100">
      <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
    </div>
    <div style="position: absolute; left: 100px; top: 650px; z-index:100">
      <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
      font-style: italic; top: 610px; ">Data analysis with R</a>
    </div>
  </footer>
</article>
<!-- Presenter Notes -->
</slide>

<style>
#slide-50 {
  background-color: #EEC900;
}
</style>
<slide class="" id="slide-51">
<hgroup>
  <h1>How would you interpret these coefficients?</h1>
</hgroup>
<article data-timings="">
  <div style="background-color:#F5F5F5; text-align:left; vertical-align: middle; padding:20px 47px;">
    <p>R generates dummy variable to be able to apply regressions on categorical variables. We can see this using the <code>model.matrix()</code> function: </p>

<pre><code class="r">model.matrix(w_log ~ loc, ChinookArg) %&gt;% 
    as.data.frame(.) %&gt;%
  # adding the location variable from the original data
  mutate(sampl_loc = ChinookArg$loc) %&gt;%
  head()
</code></pre>

<pre><code class="no-highlight">##   (Intercept) locPetrohue locPuyehue sampl_loc
## 1           1           0          0 Argentina
## 2           1           0          0 Argentina
## 3           1           0          0 Argentina
## 4           1           0          0 Argentina
## 5           1           0          0 Argentina
## 6           1           0          0 Argentina
</code></pre>

<p><small>We can see that the first 10 fish were sampled at the location &#39;Argentina&#39; and that these observations were coded 1 for the variable &#39;intercept&#39; (representing the first factor level → here Argentina) and 0 for the variable  <code>locPetrohue</code> and <code>locPuyehue</code>.</small></p>

  </div>
  <footer>
    <div style="position: absolute; left: 60px; top: 645px; z-index:100">
      <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
    </div>
    <div style="position: absolute; left: 100px; top: 650px; z-index:100">
      <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
      font-style: italic; top: 610px; ">Data analysis with R</a>
    </div>
  </footer>
</article>
<!-- Presenter Notes -->
</slide>

<style>
#slide-51 {
  background-color: #EEC900;
}
</style>
<slide class="" id="slide-52" style="background:#EEC900;">
  <hgroup>
    <h1>Apply the estimated coefficients to the regression equation with dummy variables:</h1>
  </hgroup>
  <article data-timings="">
    <p><img src="img/lm_interpretation_ANOVA.png" title="plot of chunk unnamed-chunk-40" alt="plot of chunk unnamed-chunk-40" width="750px" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-53" style="background:;">
  <hgroup>
    <h2>Only categorical X - ANOVA</h2>
  </hgroup>
  <article data-timings="">
    <p>Linear regression with a categorical variable, is the equivalent
of ANOVA (<strong>ANalysis Of VAriance</strong>). To see the output as an
ANOVA table, use <code>anova()</code> on your lm object</p>

<pre><code class="r">anova(chin_mod)
</code></pre>

<pre><code class="no-highlight">## Analysis of Variance Table
## 
## Response: w_log
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## loc         2 60.542 30.2711  73.097 &lt; 2.2e-16 ***
## Residuals 109 45.140  0.4141                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-54" style="background:;">
  <hgroup>
    <h2>Only categorical X - ANOVA</h2>
  </hgroup>
  <article data-timings="">
    <p>Alternatively, use <code>aov()</code> instead of <code>lm()</code></p>

<pre><code class="r">chin_aoc &lt;- aov(w_log ~ loc, ChinookArg)
summary(chin_aoc)
</code></pre>

<pre><code class="no-highlight">##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## loc           2  60.54  30.271    73.1 &lt;2e-16 ***
## Residuals   109  45.14   0.414                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-55" style="background:;">
  <hgroup>
    <h2>Categorical and continuous X variables: ANCOVA</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><strong>ANalysis of COVAriance</strong> (ANCOVA) is a hybrid of a linear regression and ANOVA.</li>
<li>Has at least one continuous and one categorical explanatory variable.</li>
<li>Some consider ANCOVA as an &quot;ANOVA&quot;&quot; model with a covariate included → focus on the factor levels adjusted for the covariate (e.g. <a href="http://www.cambridge.org/de/academic/subjects/life-sciences/ecology-and-conservation/experimental-design-and-data-analysis-biologists?format=PB&amp;isbn=9780521009768#Pq0cPIFm91XhGxdS.97">Quinn &amp; Keough 2002</a>).</li>
<li>Some consider it as a &quot;Regression&quot; model with a categorical predictor →  focus on the covariate adjusted for the factor (e.g. <a href="http://onlinelibrary.wiley.com/book/10.1002/9780470515075">Crawley 2007</a>).</li>
<li>The typical &quot;maximal&quot; model involves estimating an intercept and slope (regression part) for each level of the categorical variable(s) (ANOVA part) → i.e., including an interaction</li>
</ul>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-56" style="background:;">
  <hgroup>
    <h3>Chinook Salmon weight as a function of location AND length</h3>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p>without interaction
<img src="lecture14_plotting_files/unnamed-chunk-43-1.png" title="plot of chunk unnamed-chunk-43" alt="plot of chunk unnamed-chunk-43" width="432" style="display: block; margin: auto;" /></p>

</div>
<div style='float:right;width:48%;'>
  <p>with interaction
<img src="lecture14_plotting_files/unnamed-chunk-44-1.png" title="plot of chunk unnamed-chunk-44" alt="plot of chunk unnamed-chunk-44" width="432" style="display: block; margin: auto;" /></p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-57">
  <hgroup>
    <h2>Regression view of an ANCOVA</h2>
  </hgroup>
  <article class = 'flexbox vcenter'>
    <h3>\[w.log_{ij} =  \alpha_{i} + \beta_{i}*tl.log_{j} + \epsilon_{ij}\]</h3>

<p>where i = location, j = each individual fish</p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-58">
  <hgroup>
    <h2>Regression view of an ANCOVA</h2>
  </hgroup>
  <article class = 'flexbox vcenter'>
    <h3>Location-specific equations</h3>

<p>\[w.log_{Arg,j} =  \alpha_{Arg} + \beta_{Arg}*tl.log_{j} + \epsilon_{Arg,j}\]</p>

<p>\[w.log_{Pet,j} =  \alpha_{Pet} + \beta_{Pet}*tl.log_{j} + \epsilon_{Pet,j}\]</p>

<p>\[w.log_{Puy,j} =  \alpha_{Puy} + \beta_{Puy}*tl.log_{j} + \epsilon_{Puy,j}\]</p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#EEC900;">
  <hgroup>
    <h1>Your turn...</h1>
  </hgroup>
  <article>
    
  </article>
</slide>
<slide class="" id="slide-60">
<hgroup>
  <h1>ANCOVA Interpretation</h1>
</hgroup>
<article data-timings="">
  <div style="background-color:#F5F5F5; text-align:left; vertical-align: middle; padding:20px 47px;">
    <p>Run the following 2 models and formulate for both models the location-specific equations with the estimated coefficients</p>

<pre><code class="r">library(FSA)
ChinookArg &lt;- mutate(ChinookArg, 
  tl_log = log(tl), w_log = log(w))
chin_ancova1 &lt;- lm(w_log ~ loc + tl_log, ChinookArg)
chin_ancova2 &lt;- lm(w_log ~ loc * tl_log, ChinookArg)
</code></pre>

  </div>
  <footer>
    <div style="position: absolute; left: 60px; top: 645px; z-index:100">
      <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
    </div>
    <div style="position: absolute; left: 100px; top: 650px; z-index:100">
      <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
      font-style: italic; top: 610px; ">Data analysis with R</a>
    </div>
  </footer>
</article>
<!-- Presenter Notes -->
</slide>

<style>
#slide-60 {
  background-color: #EEC900;
}
</style>
<slide class="segue" style="background:#CD2626;">
  <hgroup>
    <h1>Solution</h1>
  </hgroup>
  <article>
    
  </article>
</slide>
<slide class="" id="slide-62" style="background:;">
  <hgroup>
    <h2>ANCOVA 1 - no interaction</h2>
  </hgroup>
  <article data-timings="">
    <blockquote>
<p>\(w.log = a1 + a2*locPetrohue + a3*locPuyehue+ b*tl.log\)</p>
</blockquote>

<p>The estimate for the mean weight at location <em>Argentina</em>:<br>
\(w.log_{Arg} = a1 + a2*0 + a3*0 + b*tl.log\) = <strong>-8.12+2.3*tl_log</strong></p>

<p>The estimate for the mean weight at location <em>Petrohue</em>:<br>
\(w.log_{Pet} = a1 + a2*1 + a3*0 + b*tl.log\)<br>
= -8.12+-0.23+2.3*tl_log = <strong>-8.35 + 2.3*tl_log</strong></p>

<p>The estimate for the mean weight at location <em>Puyehue</em>:<br>
\(w.log_{Puy} = a1 + a2*0 + a3*1 + b*tl.log\)<br>
= -8.12+-0.46+2.3*tl_log = <strong>-8.58+2.3 * tl_log</strong></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-63" style="background:;">
  <hgroup>
    <h2>ANCOVA 2 - with interaction</h2>
  </hgroup>
  <article data-timings="">
    <blockquote>
<p>\(\begin{eqnarray} w.log = a1 + a2*locPetrohue + a3*locPuyehue + \\ b1*tl.log+ b2*tl.log + b3*tl.log \end{eqnarray}\)</p>
</blockquote>

<p>The estimate for the mean weight at location <em>Argentina</em>:<br>
\(w.log_{Arg}\) = <strong>-6.67+2.3*tl_log</strong></p>

<p>The estimate for the mean weight at location <em>Petrohue</em>:<br>
\(w.log_{Pet}\) = -6.67+-2.4+1.98*tl_log+0.48*tl_log = <strong>-9.07 + 2.46 * tl_log</strong></p>

<p>The estimate for the mean weight at location <em>Puyehue</em>:<br>
\(w.log_{Puy}\) = = -6.67+-2.07+1.98*tl_log+0.36*tl_log = <strong>-8.74 + 2.34 * tl_log</strong></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#1874CD;">
  <hgroup>
    <h1>Model selection</h1>
  </hgroup>
  <article>
    <p><img src="img/Data_science_1c.png" style="height:150px;border:0;position: absolute; left: 900px; top: 50px" </img></p>

  </article>
</slide>
<slide class="" id="slide-65" style="background:;">
  <hgroup>
    <h2>How to compare and choose the best model?</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>Based on best goodness-of-fit: How well do the model fit a set of observations.</li>
<li>How to judge this?

<ul>
<li>visually</li>
<li>using a criterion that summarize the discrepancy between observed values and the values expected under the model, e.g.

<ul>
<li>explained variance (<strong>\(R^{2}\)</strong>)</li>
<li>Akaike&#39;s Information Criterion (<strong>AIC</strong>) and modifications</li>
<li>Bayesian Information Criterion (<strong>BIC</strong>)</li>
</ul></li>
</ul></li>
<li>A good book on that subject is written by Anderson &amp; Burnham 2002:<a href="http://www.springer.com/de/book/9780387953649"> Model Selection and Multimodel Inference - A Practical Information-Theoretic Approach</a></li>
</ul>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-66" style="background:;">
  <hgroup>
    <h2>Akaike&#39;s Information Criterion</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="img/AIC_equation.png" title="plot of chunk unnamed-chunk-48" alt="plot of chunk unnamed-chunk-48" width="600px" style="display: block; margin: auto;" /></p>

<ul>
<li>The AIC is a <strong>relative measure</strong>, not an absolute as \(R^2\): the values can only be compared between models <strong>fitted to the same observations</strong> and <strong>same Y variables</strong>. You can&#39;t compare models fitted to different data subsets or if Y is partly transformed!</li>
<li>The lower the AIC the better.</li>
<li>Rule of thumb: if difference between 2 models in AIC is <strong>&lt; 2</strong> than choose the more simple model.</li>
<li>R function: <code>AIC()</code></li>
</ul>

<div style='float:left;width:48%;'>
  
</div>
<div style='float:right;width:48%;'>
  
</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-67" style="background:;">
  <hgroup>
    <h2>Akaike&#39;s Information Criterion</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="img/AIC_equation.png" title="plot of chunk unnamed-chunk-49" alt="plot of chunk unnamed-chunk-49" width="600px" style="display: block; margin: auto;" /></p>

<ul>
<li>The AIC is a <strong>relative measure</strong>, not an absolute as \(R^2\): the values can only be compared between models <strong>fitted to the same observations</strong> and <strong>same Y variables</strong>. You can&#39;t compare models fitted to different data subsets or if Y is partly transformed!</li>
<li>The lower the AIC the better.</li>
<li>Rule of thumb: if difference between 2 models in AIC is <strong>&lt; 2</strong> than choose the more simple model.</li>
<li>R function: <code>AIC()</code></li>
</ul>

<div class="alert alert-success" style="position: absolute; left: 300px; top: 525px">
  <h4>But note:</h4> <small>the AIC can only be compared between models that are fitted on the same Y observations! Hence, models with transformed and untransformed Y <strong>cannot</strong> be directly compared using the AIC!</small>
</div>

<div style='float:left;width:48%;'>
  
</div>
<div style='float:right;width:48%;'>
  
</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-68" style="background:;">
  <hgroup>
    <h2>Akaike&#39;s Information Criterion</h2>
  </hgroup>
  <article data-timings="">
    <h3>Chinook example:</h3>

<pre><code class="r">m1 &lt;- lm(w_log ~ loc, ChinookArg)
m2 &lt;- lm(w_log ~ tl_log, ChinookArg)
m3 &lt;- lm(w_log ~ loc + tl_log, ChinookArg)
m4 &lt;- lm(w_log ~ loc * tl_log, ChinookArg)
AIC(m1, m2, m3, m4)
</code></pre>

<pre><code class="no-highlight">##    df       AIC
## m1  4 224.06339
## m2  3  87.69126
## m3  5  67.57480
## m4  7  70.53732
</code></pre>

<p>Which model shows the best performance based on the AIC?</p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-69" style="background:;">
  <hgroup>
    <h2>Principle of parsimony (Occam‘s Razor):</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>As few parameters as possible.</li>
<li>Models should be minimal adequate.</li>
<li>Simple explanations should be preferred.</li>
<li>Linear models should be preferred to non-linear models.</li>
</ul>

<p><br>
<img src="img/Cartoon_occams_razor.png" title="plot of chunk unnamed-chunk-51" alt="plot of chunk unnamed-chunk-51" width="550px" style="display: block; margin: auto;" /></p>

<p><kbd>p</kbd></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
  <aside class="note" id="">
    <section>
      <p>&quot;The principle of parsimony is attributed to the early 14th-century English nominalist philosopher, William of Occam, who insisted that, given a set of equally good explanations for a given phenomenon, the correct explanation is the simplest explanation. It is called Occam’s razor because he ‘shaved’ his explanations down to the bare minimum.&quot; (from Crawley, 2007)</p>

    </section>
  </aside>
</slide>
<slide class="segue" style="background:#CDC673;">
  <hgroup>
    <h1>Beware</h1>
  </hgroup>
  <article>
    
  </article>
</slide>
<slide class="segue" style="background:#CDC673;">
  <article>
    <p><q>There is a temptation to become personally attached to a particular model. Statisticians call this &#39;falling in love with a model&#39;.</q></p>

  </article>
</slide>
<slide class="" id="slide-72" style="background:;">
  <hgroup>
    <h3>Always keep in mind:</h3>
  </hgroup>
  <article data-timings="">
    <ul>
<li>All models are wrong, but some are useful.</li>
<li>Some models are better than others.</li>
<li>The correct model can never be known with certainty.</li>
<li>The simpler the model, the better it is.</li>
</ul>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#EEC900;">
  <hgroup>
    <h1>Your turn...</h1>
  </hgroup>
  <article>
    
  </article>
</slide>
<slide class="" id="slide-74">
<hgroup>
  <h1>Exercise: Find the &#39;true&#39; model or the underlying function</h1>
</hgroup>
<article data-timings="">
  <div style="background-color:#F5F5F5; text-align:left; vertical-align: middle; padding:20px 47px;">
    <p><img src="lecture14_plotting_files/unnamed-chunk-52-1.png" title="plot of chunk unnamed-chunk-52" alt="plot of chunk unnamed-chunk-52" width="936" style="display: block; margin: auto;" /></p>

  </div>
  <footer>
    <div style="position: absolute; left: 60px; top: 645px; z-index:100">
      <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
    </div>
    <div style="position: absolute; left: 100px; top: 650px; z-index:100">
      <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
      font-style: italic; top: 610px; ">Data analysis with R</a>
    </div>
  </footer>
</article>
<!-- Presenter Notes -->
</slide>

<style>
#slide-74 {
  background-color: #EEC900;
}
</style>
<slide class="" id="slide-75">
<hgroup>
  <h1>Exercise: Find the &#39;true&#39; model or the underlying function</h1>
</hgroup>
<article data-timings="">
  <div style="background-color:#F5F5F5; text-align:left; vertical-align: middle; padding:20px 47px;">
    <p>I generated different dataframes where the Y variable was modelled as a specific function of X plus some random noise. Load the datasets and see what objects you loaded with <code>ls()</code></p>

<pre><code class="r">load(&quot;data/find_model.R&quot;)
ls()
</code></pre>

<p>You should see 10 dataframes. Try to find the &#39;true&#39; models for df1, df2, df3, df4, and df5 by fitting different model families and compare their performance </p>

<ul>
<li>using the AIC (with function <code>AIC(model1, model2, model3,..)</code>) and </li>
<li>plotting the predicted values to the observed ones and the residual histograms.</li>
</ul>

<p>Once you think you found it, apply your models on the dataframes that do not contain the random noise (e.g. df1_nonoise for df1) and compare results.</p>

  </div>
  <footer>
    <div style="position: absolute; left: 60px; top: 645px; z-index:100">
      <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
    </div>
    <div style="position: absolute; left: 100px; top: 650px; z-index:100">
      <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
      font-style: italic; top: 610px; ">Data analysis with R</a>
    </div>
  </footer>
</article>
<!-- Presenter Notes -->
</slide>

<style>
#slide-75 {
  background-color: #EEC900;
}
</style>
<slide class="" id="slide-76" style="background:;">
  <hgroup>
    <h2>Overview of functions for modelling and interpretation</h2>
  </hgroup>
  <article data-timings="">
    <table><thead>
<tr>
<th>What</th>
<th>Function</th>
</tr>
</thead><tbody>
<tr>
<td>Lin. regression &amp; ANCOVA</td>
<td><code>lm()</code></td>
</tr>
<tr>
<td>ANOVA</td>
<td><code>aov()</code> or <code>anova(lm())</code></td>
</tr>
<tr>
<td>Coefficients</td>
<td><code>coef(mod)</code></td>
</tr>
<tr>
<td>Complete numerical output</td>
<td><code>summary(mod)</code></td>
</tr>
<tr>
<td>Confidence intervals</td>
<td><code>confint(mod)</code></td>
</tr>
<tr>
<td>Prediction</td>
<td><code>predict(mod)</code>, <code>modelr::add_predictions(data, mod)</code></td>
</tr>
<tr>
<td>Residuals</td>
<td><code>resid(mod)</code>, <code>modelr::add_residuals(data, mod)</code></td>
</tr>
<tr>
<td>Diagnostic plots</td>
<td><code>plot(mod)</code>, <code>acf(resid(mod))</code></td>
</tr>
<tr>
<td>Model comparison</td>
<td><code>AIC(mod1, mod2, mod3)</code></td>
</tr>
</tbody></table>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="segue" style="background:#CD2626;">
  <hgroup>
    <h1>How do you feel now.....?</h1>
  </hgroup>
  <article>
    
  </article>
</slide>
<slide class="" id="slide-78" style="background:;">
  <hgroup>
    <h2>Totally confused?</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="img/Comic_confused.png" title="plot of chunk unnamed-chunk-54" alt="plot of chunk unnamed-chunk-54" width="250px" style="display: block; margin: auto;" /></p>

<p>Practice on the Chinook salmon dataset and read </p>

<ul>
<li><a href="http://r4ds.had.co.nz/model-basics.html">chapter 23</a> on model basics and <a href="http://r4ds.had.co.nz/model-building.html">chapter 24</a> on model building in the &quot;R for Data Science&quot;&quot; book, as well as </li>
<li>chapter 9 (statistical modelling) in &quot;The R book&quot; (Crawley, 2013) (an online pdf version is freely available <a href="https://www.cs.upc.edu/%7Erobert/teaching/estadistica/TheRBook.pdf">here</a>).</li>
</ul>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-79">
  <hgroup>
    <h2>Totally bored?</h2>
  </hgroup>
  <article class = 'flexbox vcenter'>
    <p><img src="img/Comic_bored.png" title="plot of chunk unnamed-chunk-55" alt="plot of chunk unnamed-chunk-55" width="800px" style="display: block; margin: auto auto auto 0;" /></p>

<p>Stay tuned for the next case study where you can play around as much as you want to!</p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-80" style="background:;">
  <hgroup>
    <h2>Totally content?</h2>
  </hgroup>
  <article data-timings="">
    <p>Then go grab a coffee, lean back and enjoy the rest of the day...!</p>

<p><img src="img/Comic_hammock.png" title="plot of chunk unnamed-chunk-56" alt="plot of chunk unnamed-chunk-56" width="600px" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="thank-you-slide segue" id="slide-81">
  <footer>
    <div style="position: absolute; left: 50px; top: 50px; z-index:100">
        <img src = "assets/img/uham_logo.png" height="67" width="200">
    </div>
  </footer>
  <article>
    <h1 style="padding-top: 120px;">Thank You</h1>
    <p>
      For more information contact me:<a href="saskia.otto@uni-hamburg.de">
      saskia.otto@uni-hamburg.de</a>
      </p>
      <p data-config-contact="">
      <a href="http://www.researchgate.net/profile/Saskia_Otto"
          style="color:#F48C0A; font-weight: bold;">
        http://www.researchgate.net/profile/Saskia_Otto</a><br>
      <a href="http://www.github.com/saskiaotto"
          style="color: #F48C0A; font-weight: bold;">
        http://www.github.com/saskiaotto</a>
    </p>
    <p style="font-size: 15px; position: absolute; left: 125px; top: 480px; z-index:100">
    <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
      <img alt="Creative Commons License" style="border-width:0"
        src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a><br>
        This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
        Creative Commons Attribution-ShareAlike 4.0 International License </a>except for the <br>
        borrowed and mentioned with proper <i>source:</i> statements. <br>
        <b>Image on title and end slide:</b> Section of an infrared satallite image showing the Larsen C
        ice shelf on the Antarctic <br>
        Peninsula - USGS/NASA Landsat: <a href="https://landsat.visibleearth.nasa.gov/view.php?id=90481">
        A Crack of Light in the Polar Dark</a>, Landsat 8 - TIRS, June 17, 2017 <br>
        (under CC0 license)
    </p>
  </article>
</slide>
<slide class="segue" style="background:#CD2626;">
  <hgroup>
    <h1>Solution</h1>
  </hgroup>
  <article>
    
  </article>
</slide>
<slide class="" id="slide-83" style="background:;">
  <hgroup>
    <h2>Example to find the best model: <code>df1</code></h2>
  </hgroup>
  <article data-timings="">
    <p>1.Apply different models and compare first their AIC. </p>

<div style='float:left;width:48%;'>
  <pre><code class="r">load(&quot;data/find_model.R&quot;)
dat &lt;- df1 # this way you can simply 
# replace the dataframes later
dat$y_log &lt;- log(dat$y + 0.001)
dat$x_log &lt;- log(dat$x)

m1 &lt;- lm(y ~ x, data = dat)
m2 &lt;- lm(y ~ poly(x,2), data = dat)
m3 &lt;- lm(y ~ poly(x,3), data = dat)
m4 &lt;- lm(y_log ~ x, data = dat)
m5 &lt;- lm(y_log ~ x_log, data = dat)
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">AIC(m1,m2,m3) 
</code></pre>

<pre><code class="no-highlight">##    df       AIC
## m1  3 185.24425
## m2  4  37.56960
## m3  5  34.61143
</code></pre>

<pre><code class="r">AIC(m4,m5) 
</code></pre>

<pre><code class="no-highlight">##    df      AIC
## m4  3 174.5666
## m5  3 139.7156
</code></pre>

<div class="alert alert-success" style="position: absolute; left: 25px; top: 550px">
  <h4>Remember:</h4> <small> the AIC can only be compared between models that are fitted on the same Y observations! Hence, models with log-transformed Y values and those without CANNOT be compared using the AIC.</small>
</div>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-84" style="background:;">
  <hgroup>
    <h2>Example to find the best model: <code>df1</code></h2>
  </hgroup>
  <article data-timings="">
    <p>2.Prediction plots → to compare all models at the same scale, back-transform the log-model predictions</p>

<div style='float:left;width:48%;'>
  <pre><code class="r">dat &lt;- spread_predictions(
    data = dat, m1,m2,m3,m4,m5) %&gt;%
  mutate(m4 = (exp(m4) - 0.001),
    m5 = (exp(m5) - 0.001))

dat_long &lt;- dat %&gt;% 
  select(x, m1,m2,m3,m4,m5) %&gt;%
  gather(key = &quot;model&quot;, &quot;pred&quot;, -x) %&gt;%
  mutate(model = factor(model, 
    labels = c(&quot;m_lm&quot;, &quot;m_poly2&quot;,
    &quot;m_poly3&quot;,&quot;m_log_y&quot;,&quot;m_log_both&quot;)))

dat_long %&gt;% ggplot(aes(x,pred)) +
  geom_line(aes(colour = model)) +
  geom_point(data = dat, aes(y = y)) 
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <p><img src="lecture14_plotting_files/unnamed-chunk-60-1.png" title="plot of chunk unnamed-chunk-60" alt="plot of chunk unnamed-chunk-60" width="504" /></p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-85" style="background:;">
  <hgroup>
    <h2>Example to find the best model: <code>df1</code></h2>
  </hgroup>
  <article data-timings="">
    <p>3.Residual plots</p>

<div style='float:left;width:48%;'>
  <pre><code class="r"># Residual plots
r &lt;- dat %&gt;% 
  spread_residuals(m1,m2,m3,m4,m5) %&gt;%
  ggplot()+ geom_vline(xintercept = 0, 
    colour = &quot;blue&quot;, size = 0.5)
r1 &lt;- r + ggtitle(&quot;m_lm&quot;) +
  geom_histogram(aes(x = m1)) + 
r2 &lt;- r + ggtitle(&quot;m_poly2&quot;) +
  geom_histogram(aes(x = m2))
r3 &lt;- r + ggtitle(&quot;m_poly3&quot;) +
  geom_histogram(aes(x = m3))
r4 &lt;- r + ggtitle(&quot;m_log_y&quot;) + 
  geom_histogram(aes(x = m4)) 
r5 &lt;-  r + ggtitle(&quot;m_log_all&quot;) +
  geom_histogram(aes(x = m5)) 
gridExtra::grid.arrange(grobs = 
list(r1,r2,r3,r4,r5), ncol = 3)
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <p><img src="lecture14_plotting_files/unnamed-chunk-62-1.png" title="plot of chunk unnamed-chunk-62" alt="plot of chunk unnamed-chunk-62" width="504" /></p>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-86" style="background:;">
  <hgroup>
    <h2>Example to find the best model: <code>df1</code></h2>
  </hgroup>
  <article data-timings="">
    <p>The AIC indicates best performances for models <strong>m3</strong> (polynomial of order 3) and <strong>m5</strong> (X and X both log-transformed). Also the prediction plots and the residual plots support this. In fact, the prediction plot does not show a big difference between both models. The residual plots, on the other hand, might provide some support for m5 as a high number of y values deviate little from their predictions.</p>

<p>To really find out which model has the true underlying function, used to create this dataset, we need to apply the models on the dataset without noise:</p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-87" style="background:;">
  <hgroup>
    <h2>Example to find the best model: <code>df1_nonoise</code></h2>
  </hgroup>
  <article data-timings="">
    <p>1.Apply models to the data without noise </p>

<div style='float:left;width:48%;'>
  <pre><code class="r">dat &lt;- df1_nonoise
dat$y_log &lt;- log(dat$y + 0.001)
dat$x_log &lt;- log(dat$x)

m1 &lt;- lm(y ~ x, data = dat)
m2 &lt;- lm(y ~ poly(x,2), data = dat)
m3 &lt;- lm(y ~ poly(x,3), data = dat)
m4 &lt;- lm(y_log ~ x, data = dat)
m5 &lt;- lm(y_log ~ x_log, data = dat)
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">AIC(m1,m2,m3) 
</code></pre>

<pre><code class="no-highlight">##    df       AIC
## m1  3  156.3179
## m2  4 -397.3983
## m3  5 -990.3074
</code></pre>

<pre><code class="r">AIC(m4,m5) 
</code></pre>

<pre><code class="no-highlight">##    df         AIC
## m4  3    11.89622
## m5  3 -1066.44843
</code></pre>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-88" style="background:;">
  <hgroup>
    <h2>Example to find the best model: <code>df1_nonoise</code></h2>
  </hgroup>
  <article data-timings="">
    <p>2.Prediction plots without noise</p>

<p><img src="lecture14_plotting_files/unnamed-chunk-65-1.png" title="plot of chunk unnamed-chunk-65" alt="plot of chunk unnamed-chunk-65" width="720" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-89" style="background:;">
  <hgroup>
    <h2>Example to find the best model: <code>df1_nonoise</code></h2>
  </hgroup>
  <article data-timings="">
    <p>3.Residual plots without noise</p>

<p><img src="lecture14_plotting_files/unnamed-chunk-66-1.png" title="plot of chunk unnamed-chunk-66" alt="plot of chunk unnamed-chunk-66" width="864" style="display: block; margin: auto;" /></p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-90" style="background:;">
  <hgroup>
    <h2>Example to find the best model: <code>df1_nonoise</code></h2>
  </hgroup>
  <article data-timings="">
    <p>Now it becomes clear that the underlying function is an exponental function of the form \(Y=aX^{b}\).</p>

<p>For comparison:</p>

<div style='float:left;width:48%;'>
  <pre><code class="r"># This is the true underlying function
set.seed(123)
x &lt;- sample(20:120, size = 100, 
  replace = TRUE)
y_noise &lt;- rnorm(100, 0, 0.3)
a &lt;- exp(-10)
b &lt;- 2.5
y &lt;- a * x^b + y_noise
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">m5_comp &lt;- lm(log(y) ~ log(x))
coefficients(m5_comp)
</code></pre>

<pre><code class="no-highlight">## (Intercept)      log(x) 
##  -10.662521    2.648546
</code></pre>

</div>
    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-91" style="background:;">
  <hgroup>
    <h2>Solution of all 5 models</h2>
  </hgroup>
  <article data-timings="">
    <p>df1: \(Y_{i}=aX_{i}^{b}+\epsilon_{i}\) , with a = exp(-10), b = 2.5</p>

<p>df2: \(Y_{i}=a+b1X_{i}+b2X_{i}^{2}+b3X_{i}^{3}+\epsilon_{i}\) , with a = 1250, b1 = 400, b2 = -100, b3 = -30</p>

<p>df3: \(Y_{i}=a+b1X_{i}+b2X_{i}^{2}+\epsilon_{i}\) , with a = 100, b1 = -5, b2 = 0.5</p>

<p>df4: \(Y_{i}=ae^{bX_{i}}+\epsilon_{i}\) , with a = 20, b = 0.025</p>

<p>df5: \(Y_{i}=ae^{-bX_{i}}+\epsilon_{i}\) , with a = 10, b = -0.025</p>

    <footer>
      <div style="position: absolute; left: 60px; top: 645px; z-index:100">
        <a class="home" href="https://mareds.github.io/r_course/"><img src="assets/img/mds_logo_128px.png" alt="Home button" style="width:35px;height:35px;border:0;"></a>
      </div>
      <div style="position: absolute; left: 100px; top: 650px; z-index:100">
        <a href='https://mareds.github.io/r_course/' style="font-size: 15px;
        font-style: italic; top: 610px; ">Data analysis with R</a>
      </div>
    </footer>
  </article>
  <!-- Presenter Notes -->
</slide>
    <slide class="backdrop"></slide>
  </slides>
  <div class="pagination pagination-small" id='io2012-ptoc' style="display:none;">
    <ul>
      <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=1 title='Model building'>
         1
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=2 title='Model building in 6 steps'>
         2
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=3 title='NA'>
         3
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=4 title='NA'>
         4
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=5 title='NA'>
         5
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=6 title='NA'>
         6
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=7 title='NA'>
         7
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=8 title='NA'>
         8
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=9 title='NA'>
         9
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=10 title='NA'>
         10
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=11 title='1. Defining the model family'>
         11
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=12 title='Aim'>
         12
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=13 title='The function for a straight line is \(Y = a + bX\)'>
         13
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=14 title='Quadratic relationships \(Y=a+bX+cX^{2}\)'>
         14
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=15 title='Taylor’s theorem'>
         15
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=16 title='Exponential growth or decay'>
         16
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=17 title='Exponential growth or decay'>
         17
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=18 title='Linearizating relationships through transformations'>
         18
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=19 title='Example: Weight ~ Length relationship'>
         19
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=20 title='Applying the bulging rule'>
         20
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=21 title='General rule for common transformations'>
         21
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=22 title='2. Generate a fitted model'>
         22
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=23 title='Once you defined the model family'>
         23
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=24 title='An overview of common linear models'>
         24
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=25 title='Defining the model family in the R formula'>
         25
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=26 title='Formulas'>
         26
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=27 title='Formulas (cont)'>
         27
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=28 title='Categorical X variables'>
         28
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=29 title='NA'>
         29
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=30 title='NA'>
         30
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=31 title='Overview of model formulae in R'>
         31
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=32 title='3. Partition your model'>
         32
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=33 title='Partition your model into predicted values and residuals'>
         33
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=34 title='4. Model the remaining noise'>
         34
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=35 title='2 different ways to understand what the model captures'>
         35
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=36 title='Residual patterns'>
         36
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=37 title='Best practice:'>
         37
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=38 title='5. Extend your fitted model with more X'>
         38
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=39 title='Chinook Salmon example: add <code>loc</code> as X variable to the model'>
         39
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=40 title='NA'>
         40
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=41 title='NA'>
         41
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=42 title='6. Test for interactions'>
         42
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=43 title='Chinook Salmon example: include <code>tl_log:loc</code> interaction'>
         43
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=44 title='NA'>
         44
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=45 title='NA'>
         45
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=46 title='Interpreting models with categorical X variables'>
         46
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=47 title='Recall: Categorical X variables'>
         47
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=48 title='Only categorical X'>
         48
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=49 title='Your turn...'>
         49
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=50 title='How would you interpret these coefficients?'>
         50
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=51 title='How would you interpret these coefficients?'>
         51
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=52 title='Apply the estimated coefficients to the regression equation with dummy variables:'>
         52
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=53 title='Only categorical X - ANOVA'>
         53
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=54 title='Only categorical X - ANOVA'>
         54
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=55 title='Categorical and continuous X variables: ANCOVA'>
         55
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=56 title='Chinook Salmon weight as a function of location AND length'>
         56
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=57 title='Regression view of an ANCOVA'>
         57
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=58 title='Regression view of an ANCOVA'>
         58
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=59 title='Your turn...'>
         59
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=60 title='ANCOVA Interpretation'>
         60
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=61 title='Solution'>
         61
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=62 title='ANCOVA 1 - no interaction'>
         62
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=63 title='ANCOVA 2 - with interaction'>
         63
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=64 title='Model selection'>
         64
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=65 title='How to compare and choose the best model?'>
         65
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=66 title='Akaike&#39;s Information Criterion'>
         66
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=67 title='Akaike&#39;s Information Criterion'>
         67
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=68 title='Akaike&#39;s Information Criterion'>
         68
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=69 title='Principle of parsimony (Occam‘s Razor):'>
         69
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=70 title='Beware'>
         70
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=71 title='NA'>
         71
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=72 title='Always keep in mind:'>
         72
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=73 title='Your turn...'>
         73
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=74 title='Exercise: Find the &#39;true&#39; model or the underlying function'>
         74
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=75 title='Exercise: Find the &#39;true&#39; model or the underlying function'>
         75
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=76 title='Overview of functions for modelling and interpretation'>
         76
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=77 title='How do you feel now.....?'>
         77
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=78 title='Totally confused?'>
         78
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=79 title='Totally bored?'>
         79
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=80 title='Totally content?'>
         80
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=81 title='NA'>
         81
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=82 title='Solution'>
         82
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=83 title='Example to find the best model: <code>df1</code>'>
         83
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=84 title='Example to find the best model: <code>df1</code>'>
         84
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=85 title='Example to find the best model: <code>df1</code>'>
         85
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=86 title='Example to find the best model: <code>df1</code>'>
         86
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=87 title='Example to find the best model: <code>df1_nonoise</code>'>
         87
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=88 title='Example to find the best model: <code>df1_nonoise</code>'>
         88
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=89 title='Example to find the best model: <code>df1_nonoise</code>'>
         89
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=90 title='Example to find the best model: <code>df1_nonoise</code>'>
         90
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=91 title='Solution of all 5 models'>
         91
      </a>
    </li>
  </ul>
  </div>  <!--[if IE]>
    <script
      src="https://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
  <!-- Load Javascripts for Widgets -->
  <script src="libraries/widgets/quiz/js/jquery.quiz.js"></script>
<script src="libraries/widgets/quiz/js/mustache.min.js"></script>
<script src="libraries/widgets/quiz/js/quiz-app.js"></script>
<script src="libraries/widgets/bootstrap/js/bootstrap.min.js"></script>
<script src="libraries/widgets/bootstrap/js/bootbox.min.js"></script>
<script src="libraries/widgets/interactive/js/ace/js/ace.js"></script>
<script src="libraries/widgets/interactive/js/opencpu-0.5.js"></script>
<script src="libraries/widgets/interactive/js/interactive.js"></script>

  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
  </script>
  <!-- following line slidify default but is outdated -->
  <!-- <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
  
  <!-- accoding to https://www.mathjax.org/#gettingstarted  this is the line of code to
    change the version number in the src attribute any time the version of MathJax changes
    (Although this refers to a specific version, the latest.js file will load the most current version regardless of the one you specified.)
  -->
    <script type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
  
  <!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script> -->
  <script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<script>  
  $(function (){ 
    $("#example").popover(); 
    $("[rel='tooltip']").tooltip(); 
  });  
  </script>  
  <!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>